/*VEHICLE TABLE*/
CREATE TABLE VEHICLE(
VEHID INT,
VEHNAME VARCHAR(10)
);
ALTER TABLE VEHICLE ADD PRIMARY KEY(VEHID);
ALTER TABLE VEHICLE RENAME COLUMN VEHNAME TO VEHTYPE;

/*COMPANY TABLE*/
CREATE TABLE COMPANY(
COID INT,
CONAME VARCHAR(20),
PRIMARY KEY(COID)
);

/*EMPLOYEE TABLE*/
CREATE TABLE EMPLOYEE(
EMPID INT,
EMPNAME VARCHAR(20),
COID INT,
PRIMARY KEY(EMPID)
);
ALTER TABLE EMPLOYEE ADD FOREIGN KEY(COID) REFERENCES COMPANY(COID);

/*PARKING PASS TABLE*/
CREATE TABLE PARKINGPASS(
PPID INT,
PPTYPE VARCHAR(10),
PRIMARY KEY(PPID)
);

ALTER TABLE PARKINGPASS ADD COLUMN PP_STATUS VARCHAR(10);

/*DELETED EPP TABLE*/
CREATE TABLE EPP(
EMPID INT,
PPID INT,
COID INT
);
ALTER TABLE EPP ADD COLUMN VEHID INT;
ALTER TABLE EPP DROP COLUMN COID;
DROP TABLE EPP;
DESC EPP;

/*EMP_PP TABLE*/
CREATE TABLE EMP_PP(
ACTIVEPP VARCHAR(10) PRIMARY KEY,
EMPID INT,
PPID INT,
VEHID INT
);

DESC VEHICLE;
DESC EMPLOYEE;
DESC COMPANY;
DESC PARKINGPASS;
DESC EMP_PP;

INSERT INTO COMPANY VALUES(11,'PRODAPT');
INSERT INTO COMPANY VALUES(22,'IBM');
INSERT INTO COMPANY VALUES(33,'TCS');
INSERT INTO COMPANY VALUES(44,'INFOSYS');
INSERT INTO COMPANY VALUES(55,'GALAXY'),(66,'DELL'),(77,'AMAZON'),(88,'DXC'),(99,'SAMSUNG'),(00,'MINDTREE');

SELECT * FROM COMPANY;

INSERT INTO EMPLOYEE VALUES(1101,'AJAY',11);
INSERT INTO EMPLOYEE VALUES(1102,'NAVEEN',11);
INSERT INTO EMPLOYEE VALUES(1103,'RADHA',11);
INSERT INTO EMPLOYEE VALUES(1104,'NIRMALA',11);
INSERT INTO EMPLOYEE VALUES(1105,'KRISHNA',11);
INSERT INTO EMPLOYEE VALUES(1106,'SHIVA',11);
INSERT INTO EMPLOYEE VALUES(1107,'SURESH',11);
INSERT INTO EMPLOYEE VALUES(2201,'SUJATHA',22);
INSERT INTO EMPLOYEE VALUES(2202,'LATHA',22);
INSERT INTO EMPLOYEE VALUES(3301,'ANJALI',33);
INSERT INTO EMPLOYEE VALUES(3302,'KARTHIK',33);
INSERT INTO EMPLOYEE VALUES(4401,'SAM',44);
INSERT INTO EMPLOYEE VALUES(4402,'SAM',44),(5501,'LIZA',55),(5502,'ANKITH',55),(6601,'SWALEHA',66),(6602,'JASWANTH',66),(7701,'NISHA',77),(7702,'RAHUL',77),(8801,'SANA',88),(9901,'MANAS',99),(0001,'JHANVI',00);

SELECT * FROM EMPLOYEE;

INSERT INTO VEHICLE VALUES(201,'2-WHEELER'),(202,'2-WHEELER'),(203,'2-WHEELER'),(204,'2-WHEELER'),(205,'2-WHEELER'),(401,'4-WHEELER'),(402,'4-WHEELER'),(403,'4-WHEELER'),(404,'4-WHEELER'),(405,'4-WHEELER');
INSERT INTO VEHICLE VALUES(206,'2-WHEELER'),(207,'2-WHEELER'),(208,'2-WHEELER'),(209,'2-WHEELER'),(210,'2-WHEELER');
 
SELECT * FROM VEHICLE; 

INSERT INTO PARKINGPASS VALUES(1,'2-WHEELER','REQUESTED'),(2,'4-WHEELER','IN-PROCESS'),(3,'2-WHEELER','APPROVED'),(4,'2-WHEELER','DELETED'),(5,'4-WHEELER','REQUESTED'),(6,'2-WHEELER','IN-PROCESS'),(7,'4-WHEELER','REQUESTED'),(8,'4-WHEELER','APPROVED'),(9,'2-WHEELER','DELETED'),(10,'2-WHEELER','APPROVED');
INSERT INTO PARKINGPASS VALUES(11,'2-WHEELER','APPROVED'),(12,'2-WHEELER','APPROVED'),(13,'2-WHEELER','APPROVED'),(14,'2-WHEELER','APPROVED'),(15,'2-WHEELER','APPROVED');
SELECT * FROM PARKINGPASS; 

INSERT INTO EMP_PP VALUES(1001,1102,3,202),(1002,4402,8,403),(1003,7701,10,205);
INSERT INTO EMP_PP VALUES(1004,1103,11,206),(1005,1104,12,207),(1006,1105,13,208),(1007,1106,14,209),(1008,1107,15,210);

SELECT * FROM EMP_PP;

SELECT DISTINCT VEHTYPE FROM VEHICLE;

SELECT * FROM VEHICLE WHERE VEHTYPE='2-WHEELER';

SELECT * FROM EMPLOYEE ORDER BY EMPNAME;

SELECT * FROM EMPLOYEE WHERE COID=22 AND EMPNAME LIKE 'S%';

/* COUNT OPERATOR */
SELECT MAX(EMPID) FROM EMPLOYEE;
SELECT MIN(EMPID) FROM EMPLOYEE;

/* COUNT OPERATOR */
SELECT COUNT(*) FROM VEHICLE;
SELECT COUNT(VEHTYPE) FROM VEHICLE WHERE VEHTYPE='2-WHEELER';

/* BETWEEN OPERATOR */
SELECT * FROM EMPLOYEE WHERE EMPID BETWEEN 1101 AND 8801;

/* IN OPERATOR */
DESC PARKINGPASS;
SELECT * FROM PARKINGPASS WHERE PP_STATUS IN ('REQUESTED');
SELECT * FROM PARKINGPASS WHERE PP_STATUS IN ('APPROVED','IN-PROCESS');

/* ALIASES OPERATOR */
SELECT EMPID AS EMP FROM EMPLOYEE;

/*ORDER BY AND GROUP BY*/
SELECT * FROM EMPLOYEE WHERE COID=22 GROUP BY EMPID;
SELECT * FROM EMPLOYEE WHERE COID=22 GROUP BY EMPID ORDER BY EMPID;
SELECT * FROM EMPLOYEE WHERE COID=22 GROUP BY EMPID ORDER BY EMPID DESC;

SELECT COUNT(VEHTYPE),VEHTYPE FROM VEHICLE GROUP BY VEHTYPE;

/*HAVING CLAUSE*/
SELECT COUNT(VEHTYPE),VEHTYPE FROM VEHICLE GROUP BY VEHTYPE HAVING COUNT(VEHTYPE)>4;
SELECT COUNT(VEHTYPE),VEHTYPE FROM VEHICLE GROUP BY VEHTYPE HAVING COUNT(VEHTYPE)>4 ORDER BY COUNT(VEHTYPE);

SELECT COUNT(VEHTYPE),VEHTYPE FROM VEHICLE GROUP BY VEHTYPE HAVING COUNT(VEHTYPE)>4 ORDER BY COUNT(VEHTYPE) DESC;

/* UNION */
SELECT CONAME FROM COMPANY UNION SELECT COID FROM EMPLOYEE;

/* ALL JOINS */
/* INNER JOINS */
SELECT * FROM EMPLOYEE;
SELECT * FROM COMPANY;
SELECT * FROM EMPLOYEE INNER JOIN COMPANY ON EMPLOYEE.COID=COMPANY.COID;
SELECT * FROM COMPANY INNER JOIN EMPLOYEE ON EMPLOYEE.COID=COMPANY.COID;
/*ANOTHER TABLE*/
SELECT * FROM EMPLOYEE INNER JOIN EMP_PP ON EMPLOYEE.EMPID=EMP_PP.EMPID;

/* LEFT JOINS */
SELECT * FROM EMPLOYEE LEFT JOIN COMPANY ON EMPLOYEE.COID=COMPANY.COID;
/*ANOTHER TABLE*/
SELECT * FROM EMPLOYEE LEFT JOIN EMP_PP ON EMPLOYEE.EMPID=EMP_PP.EMPID;

/* RIGHT JOINS */
SELECT * FROM EMPLOYEE RIGHT JOIN COMPANY ON EMPLOYEE.COID=COMPANY.COID;
/*ANOTHER TABLE*/
SELECT * FROM EMPLOYEE RIGHT JOIN EMP_PP ON EMPLOYEE.EMPID=EMP_PP.EMPID;

/* FULL JOINS */
SELECT * FROM EMPLOYEE FULL OUTER JOIN COMPANY ON EMPLOYEE.COID=COMPANY.COID ORDER BY COID;
/*ANOTHER TABLE*/
SELECT * FROM EMPLOYEE FULL JOIN EMP_PP ON EMPLOYEE.EMPID=EMP_PP.EMPID;

/*LIMIT KEYWORD*/
SELECT * FROM COMPANY LIMIT 5;
SELECT * FROM PARKINGPASS WHERE PP_STATUS='REQUESTED' LIMIT 3;
SELECT * FROM VEHICLE WHERE VEHTYPE='2-WHEELER' LIMIT 4;

/**/
SELECT CONCAT('G',' Elita',' Hazel') AS CONCATENATEDSTRING;
SELECT FORMAT(234567.3456789,5);
SELECT LCASE('I AM A FUTURE PRODAPTIAN');
SELECT UCASE("oh happy day!!!");
SELECT REPLACE("I AM TIRED","TIRED","VERY MUCH TIRED");
SELECT TRIM("      HAVE A NICE DAY     ");

/**/
SELECT * FROM EMPLOYEE WHERE COID=(SELECT COID FROM COMPANY WHERE CONAME='TCS');

SELECT EMPID FROM EMPLOYEE WHERE COID=11;

SELECT * FROM EMP_PP WHERE(SELECT EMPID FROM EMPLOYEE WHERE COID=11);

SELECT * FROM EMP_PP;


SELECT * FROM EMP_PP WHERE EMPID=(SELECT EMPID FROM EMPLOYEE WHERE COID='11');

SELECT PP_STATUS FROM PARKINGPASS WHERE PP_STATUS='APPROVED' AND PPTYPE='2-WHEELER' LIMIT 1;

/**/
SELECT EMPID,(SELECT PP_STATUS FROM PARKINGPASS WHERE PPID=1) FROM EMPLOYEE;

SELECT GETDATE();
SELECT SYSDATE();

SELECT EMPNAME,(SELECT current_timestamp()) FROM EMPLOYEE;
SELECT EMPNAME,(SELECT current_USER()) FROM EMPLOYEE;
SELECT EMPNAME,(SELECT current_time()) FROM EMPLOYEE;

/* how to select 2 values in using sub queries! */
SELECT EMPNAME,(SELECT current_timestamp()),(select curdate()) FROM EMPLOYEE;
SELECT EMPNAME,(SELECT current_timestamp()),(curdate())FROM EMPLOYEE;







